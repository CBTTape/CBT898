//&JOBID JOB &ACCT,'&PROG',MSGCLASS=&MCL,NOTIFY=&&SYSUID,
//       CLASS=&XCL,MSGLEVEL=(1,1)
//*
//*******************************************************************//
//*                                                                 *//
//*This job was created using the %VT command against skeleton      *//
//*  'VTOCBCRE)'.                                                   *//
//*                                                                 *//
//*Designed to execute the VTOC command from batch.                 *//
//*  This JCL is generated by executing '%VT' under an interactive  *//
//*  ISPF environment, entering all the required parameters, and    *//
//*  after testing and satisfaction with the rep¢ort format, enter- *//
//*  ing "Y" against 'gen jcl' option on the panel.                 *//
//*                                                                 *//
//*The gen'd JCL then can be saved whereever desired.               *//
//*                                                                 *//
//*Processing logic:                                                *//
//*  A temporary PDS is created to hold the REXX that will be       *//
//*  executed under ISPF to issue the VTOC command.                 *//
//*  This is required as the VTOC program has been codded to accept *//
//*  parameters passed through the command processor, rather than   *//
//*  the conventional register 1 means.                             *//
//*                                                                 *//
//*  1. The first step generates the REXX with the parameters       *//
//*     passed from the interactive VT session and stores it in     *//
//*     a temporary PDS.                                            *//
//*  2. The second step executes the REXX and deletes the temp      *//
//*     PDS.                                                        *//
//*                                                                 *//
//*******************************************************************//
//*                                                                 *//
//STEP1 EXEC PGM=IEBUPDTE,PARM=NEW
//*                                                                 *//
//*  CREATE THE TEMP PDS AND THE MEMBER TO EXECUTE THE VTOC PROG    *//
//*                                                                 *//
//SYSPRINT DD SYSOUT=*
//SYSUT2   DD DSN=&&TEMPPDS,
//       DISP=(NEW,PASS),UNIT=SYSALLDA,SPACE=(TRK,(2,1,1)),
//       DCB=(RECFM=FB,LRECL=80,BLKSIZE=6160)
//SYSIN  DD DATA,DLM=$$
./ ADD NAME=VTOCBTCH
/******************************** REXX ********************************/
/**********************************************************************/
/* TRACE r                                                            */
/*--------------------------ooo000OOOO000ooo--------------------------*/
/*                                                                    */
/* REXX  to execute the 'VTOC' program to accept parameters passed    */
/*   through the command processor.                                   */
/*                                                                    */
/*--------------------------------------------------------------------*/
    Arg dvtoc parm2
    If parm2 = 'TRACE' Then Trace r
)BLANK
    Address TSO
)SEL &DVTOC ¬= SYSOUT
)SEL &ODISP = SHR
    'DELETE' dvtoc
    'ALLOC F(VTOCOUT) DA('dvtoc') NEW SPACE(20,10) CYLINDERS',
         'RECFM(F B)BLKSIZE(0) LRECL(150) DSORG(PS)',
         'UNIT(SYSDA) RELEASE CATALOG'
)ENDSEL &ODISP = SHR
)SEL &ODISP = MOD
    If Sysdsn(dvtoc) = 'OK' Then,
        'ALLOC F(VTOCOUT) DA('dvtoc') MOD REU'
    Else,
        'ALLOC F(VTOCOUT) DA('dvtoc') MOD SPACE(20,10) CYLINDERS',
             'RECFM(F B)BLKSIZE(0) LRECL(150) DSORG(PS)',
             'UNIT(SYSDA) RELEASE CATALOG'
)ENDSEL &ODISP = MOD
)BLANK
    levels=&STRING
    Do While levels/=''
        Parse VAR levels alias ',' levels
)ENDSEL &DVTOC ¬= SYSOUT
        &OPER0
        &OPER1
        &OPER2
        &OPER3
        &OPER4
        &OPER5
        &OPERZ
    End
)BLANK
    Return rc
./ ENDUP
$$
//*
//*******************************************************************//
//*  Execute the clist created in step 1 then delete temp pds       *//
//*******************************************************************//
//STEP2    EXEC PGM=IKJEFT01,DYNAMNBR=65,REGION=6500K
//STEPLIB  DD DISP=SHR,DSN=&LOADLIB
//SYSPROC  DD DISP=(OLD,DELETE),DSN=&&TEMPPDS
)SEL &DVTOC = SYSOUT
//VTOCOUT  DD SYSOUT=X
)ENDSEL &DVTOC ¬= SYSOUT
//SYSTSPRT DD SYSOUT=*
//SYSTSIN  DD *
%VTOCBTCH &DVTOC XTRACE
/*
//
